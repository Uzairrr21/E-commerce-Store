{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\DELL\\\\OneDrive\\\\Desktop\\\\ecommerce-store\\\\frontend\\\\src\\\\context\\\\AppContext.js\",\n  _s = $RefreshSig$();\nimport React, { createContext, useReducer, useEffect, useCallback } from 'react';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AppContext = /*#__PURE__*/createContext();\nconst safeParse = (key, defaultValue) => {\n  try {\n    const item = localStorage.getItem(key);\n    return item ? JSON.parse(item) : defaultValue;\n  } catch (error) {\n    console.error(`Error parsing ${key} from localStorage`, error);\n    return defaultValue;\n  }\n};\nconst initialState = {\n  userInfo: safeParse('userInfo', null),\n  cart: {\n    cartItems: safeParse('cartItems', []),\n    shippingAddress: safeParse('shippingAddress', {}),\n    paymentMethod: localStorage.getItem('paymentMethod') || ''\n  },\n  loading: false,\n  error: null\n};\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'REQUEST_START':\n      return {\n        ...state,\n        loading: true,\n        error: null\n      };\n    case 'REQUEST_SUCCESS':\n      return {\n        ...state,\n        loading: false\n      };\n    case 'REQUEST_FAIL':\n      return {\n        ...state,\n        loading: false,\n        error: action.payload\n      };\n    case 'USER_LOGIN':\n      return {\n        ...state,\n        userInfo: {\n          ...action.payload,\n          isAdmin: action.payload.isAdmin || false // Ensure isAdmin is set\n        }\n      };\n    case 'USER_LOGOUT':\n      return {\n        ...state,\n        userInfo: null,\n        cart: {\n          cartItems: [],\n          shippingAddress: {},\n          paymentMethod: ''\n        }\n      };\n    // ... (keep other reducer cases the same)\n    default:\n      return state;\n  }\n}\nexport function AppProvider({\n  children\n}) {\n  _s();\n  const [state, dispatch] = useReducer(reducer, initialState);\n\n  // Sync state with localStorage\n  useEffect(() => {\n    const syncLocalStorage = () => {\n      try {\n        if (state.userInfo) {\n          localStorage.setItem('userInfo', JSON.stringify(state.userInfo));\n        } else {\n          localStorage.removeItem('userInfo');\n        }\n        // ... (keep other localStorage sync logic)\n      } catch (error) {\n        console.error('Error syncing with localStorage:', error);\n      }\n    };\n    syncLocalStorage();\n  }, [state.userInfo, state.cart]);\n  const api = axios.create({\n    baseURL: process.env.REACT_APP_API_URL || 'http://localhost:5000',\n    withCredentials: true,\n    timeout: 10000\n  });\n  api.interceptors.request.use(config => {\n    var _state$userInfo;\n    if ((_state$userInfo = state.userInfo) !== null && _state$userInfo !== void 0 && _state$userInfo.token) {\n      config.headers.Authorization = `Bearer ${state.userInfo.token}`;\n    }\n    return config;\n  });\n\n  // ... (keep other context functions the same)\n\n  return /*#__PURE__*/_jsxDEV(AppContext.Provider, {\n    value: {\n      state,\n      dispatch,\n      login,\n      logout\n      // ... (other context values)\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 91,\n    columnNumber: 5\n  }, this);\n}\n_s(AppProvider, \"bgCdjuTOmPdSBRwTap80EFd9Y3U=\");\n_c = AppProvider;\nvar _c;\n$RefreshReg$(_c, \"AppProvider\");","map":{"version":3,"names":["React","createContext","useReducer","useEffect","useCallback","axios","jsxDEV","_jsxDEV","AppContext","safeParse","key","defaultValue","item","localStorage","getItem","JSON","parse","error","console","initialState","userInfo","cart","cartItems","shippingAddress","paymentMethod","loading","reducer","state","action","type","payload","isAdmin","AppProvider","children","_s","dispatch","syncLocalStorage","setItem","stringify","removeItem","api","create","baseURL","process","env","REACT_APP_API_URL","withCredentials","timeout","interceptors","request","use","config","_state$userInfo","token","headers","Authorization","Provider","value","login","logout","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/DELL/OneDrive/Desktop/ecommerce-store/frontend/src/context/AppContext.js"],"sourcesContent":["import React, { createContext, useReducer, useEffect, useCallback } from 'react';\r\nimport axios from 'axios';\r\n\r\nexport const AppContext = createContext();\r\n\r\nconst safeParse = (key, defaultValue) => {\r\n  try {\r\n    const item = localStorage.getItem(key);\r\n    return item ? JSON.parse(item) : defaultValue;\r\n  } catch (error) {\r\n    console.error(`Error parsing ${key} from localStorage`, error);\r\n    return defaultValue;\r\n  }\r\n};\r\n\r\nconst initialState = {\r\n  userInfo: safeParse('userInfo', null),\r\n  cart: {\r\n    cartItems: safeParse('cartItems', []),\r\n    shippingAddress: safeParse('shippingAddress', {}),\r\n    paymentMethod: localStorage.getItem('paymentMethod') || '',\r\n  },\r\n  loading: false,\r\n  error: null,\r\n};\r\n\r\nfunction reducer(state, action) {\r\n  switch (action.type) {\r\n    case 'REQUEST_START':\r\n      return { ...state, loading: true, error: null };\r\n    case 'REQUEST_SUCCESS':\r\n      return { ...state, loading: false };\r\n    case 'REQUEST_FAIL':\r\n      return { ...state, loading: false, error: action.payload };\r\n    case 'USER_LOGIN':\r\n      return { \r\n        ...state, \r\n        userInfo: {\r\n          ...action.payload,\r\n          isAdmin: action.payload.isAdmin || false  // Ensure isAdmin is set\r\n        } \r\n      };\r\n    case 'USER_LOGOUT':\r\n      return {\r\n        ...state,\r\n        userInfo: null,\r\n        cart: { cartItems: [], shippingAddress: {}, paymentMethod: '' },\r\n      };\r\n    // ... (keep other reducer cases the same)\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nexport function AppProvider({ children }) {\r\n  const [state, dispatch] = useReducer(reducer, initialState);\r\n\r\n  // Sync state with localStorage\r\n  useEffect(() => {\r\n    const syncLocalStorage = () => {\r\n      try {\r\n        if (state.userInfo) {\r\n          localStorage.setItem('userInfo', JSON.stringify(state.userInfo));\r\n        } else {\r\n          localStorage.removeItem('userInfo');\r\n        }\r\n        // ... (keep other localStorage sync logic)\r\n      } catch (error) {\r\n        console.error('Error syncing with localStorage:', error);\r\n      }\r\n    };\r\n    syncLocalStorage();\r\n  }, [state.userInfo, state.cart]);\r\n\r\n  const api = axios.create({\r\n    baseURL: process.env.REACT_APP_API_URL || 'http://localhost:5000',\r\n    withCredentials: true,\r\n    timeout: 10000,\r\n  });\r\n\r\n  api.interceptors.request.use((config) => {\r\n    if (state.userInfo?.token) {\r\n      config.headers.Authorization = `Bearer ${state.userInfo.token}`;\r\n    }\r\n    return config;\r\n  });\r\n\r\n  // ... (keep other context functions the same)\r\n\r\n  return (\r\n    <AppContext.Provider\r\n      value={{\r\n        state,\r\n        dispatch,\r\n        login,\r\n        logout,\r\n        // ... (other context values)\r\n      }}\r\n    >\r\n      {children}\r\n    </AppContext.Provider>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}